---
title: "[Spring] ìŠ¤í”„ë§ ê¸°ë³¸ 1 - DIP, OCP ì›ì¹™ê³¼ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆ"
---

ğŸ’¡

í•´ë‹¹ ì‹œë¦¬ì¦ˆëŠ” ì¸í”„ëŸ°ì˜ ê¹€ì˜í•œ ê°•ì‚¬ë‹˜ [[ë§í¬]'ìŠ¤í”„ë§ í•µì‹¬ì›ë¦¬ - ê¸°ë³¸í¸' ](https://inf.run/n6jw) ê°•ì˜ ë‚´ìš© ë³µìŠµì„ ìœ„í•´ ë‚´ìš©ê³¼ ì†ŒìŠ¤ë¥¼ ì¬êµ¬ì„±í•˜ì—¬ ì‘ì„±í•˜ì˜€ìŠµë‹ˆë‹¤.
1. **ìŠ¤í”„ë§ ê¸°ë³¸ 1 - DIP, OCP ì›ì¹™ê³¼ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆ**
2. [ìŠ¤í”„ë§ ê¸°ë³¸ 2 - ì‹±ê¸€í†¤ íŒ¨í„´ê³¼ ì‹±ê¸€í†¤ ì»¨í…Œì´ë„ˆ](../spring-%EA%B8%B0%EB%B3%B8-2/)
3. [ìŠ¤í”„ë§ ê¸°ë³¸ 3 - ë¹ˆ ìŠ¤ì½”í”„ì™€ ìƒëª…ì£¼ê¸°](../spring-%EA%B8%B0%EB%B3%B8-3)

## 1. ê°œìš”

ë°ì´í„°ë² ì´ìŠ¤ê°€ ì •í•´ì§€ì§€ ì•Šì•„ì„œ ì„ì‹œ ë©”ëª¨ë¦¬ ì €ì¥ì†Œë¥¼ êµ¬í˜„í•´ì„œ ê°œë°œí•˜ë˜ ì¤‘, DBê°€ í™•ì •ë˜ê³  JPAë¡œ ë ˆí¬ì§€í„°ë¦¬ ë ˆì´ì–´ë¥¼ êµ¬í˜„í•œë‹¤ê³  ê°€ì •í•œë‹¤. DI ì»¨í…Œì´ë„ˆ, í˜¹ì€ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì— ëŒ€í•´ ê³µë¶€í•˜ê¸° ì „ì—ëŠ” ì˜ì¡´ê´€ê³„ë¥¼ ì§ì ‘ êµ¬í˜„ì²´ë¥¼ ì„¤ì •í•˜ì—¬ ì§€ì •í•´ ì£¼ì—ˆì§€ë§Œ, ì´ëŠ” SOLID 5ì›ì¹™ ì¤‘ DIP, OCPì— ìœ„ë°°ë˜ëŠ” ë°©ì‹ì´ë‹¤. ê·¸ë ‡ë‹¤ë©´ ê°ì²´ì§€í–¥ì ì¸ ì„¤ê³„ë¥¼ ìœ„í•´ì„œëŠ” ì–´ë–»ê²Œ í•´ì•¼ í• ê¹Œ?
![](/assets/images/ghost_images/2023/01/image-1.png)ë³€ê²½ ì „![](/assets/images/ghost_images/2023/01/image-2.png)ë³€ê²½ í›„
## 2. ìŠ¤í”„ë§ì´ ì—†ë‹¤ê³  ê°€ì •í•˜ë©´

ë¨¼ì € ìš°ë¦¬ê°€ ìµœì¢…ì ìœ¼ë¡œ ì„±ê³µí•´ì•¼ í•˜ëŠ” í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ë¨¼ì € ì‘ì„± í•´ë³´ì.

    class MemberServiceImplTest {
    	
        //ì•„ì§ ë³„ë‹¤ë¥¸ DI ì»¨í…Œì´ë„ˆê°€ ì—†ìœ¼ë¯€ë¡œ 
        //ì„œë¹„ìŠ¤ ê°ì²´ë„ ì§ì ‘ ìƒì„±í•˜ì—¬ ì£¼ì…í•˜ë„ë¡ í•œë‹¤.
        MemberService memberService = new MemberServiceImpl();
    
        @Test
        @DisplayName("íšŒì›ê°€ì… ì„±ê³µ")
        void join() {
            //given
            Member member = new Member("name", MemberGrade.USER);
    
            //when
            Long joinedId = memberService.join(member);
    
            //then
            Member findMember = memberService.findOne(joinedId).get();
            Assertions.assertThat(findMember.getId()).isEqualTo(member.getId());
            Assertions.assertThat(findMember.getGrade())
            	.isEqualTo(member.getGrade());
        }
    
    }

ë§Œì•½ ìŠ¤í”„ë§ì˜ ê¸°ëŠ¥ì´ ì—†ì´ êµ¬í˜„ì²´ë¥¼ ì„¤ì •í•œë‹¤ê³  í•˜ë©´ ë‹¤ìŒê³¼ ê°™ì´ ë‹¤í˜•ì„±ì„ ì´ìš©í•´ë³¼ ìˆ˜ ìˆë‹¤.

    public class MemberServiceImpl implements MemberService {
    
    	//private MemberRepository memberRepository = new MemoryMemberRepository();
        private MemberRepository memberRepository = new JpaMemberRepository();
        
        // ì´í•˜ ì„œë¹„ìŠ¤ ë¡œì§

ë‹¤ìŒê³¼ ê°™ì´ ì˜ì¡´ì„±ì„ ì§ì ‘ ìˆ˜ì •í•´ ì£¼ì—ˆë‹¤ë©´ í…ŒìŠ¤íŠ¸ ì½”ë“œë„ ì˜ í†µê³¼í•  ê²ƒì´ë‹¤.

í•˜ì§€ë§Œ ìœ„ì™€ ê°™ì€ ì½”ë“œëŠ” ì‚¬ì‹¤ ìœ„ì—ì„œ ì„œìˆ í–ˆë“¯ DIP, OCP ì›ì¹™ì— ìœ„ë°°ëœë‹¤.

â˜ï¸

DIP - ì˜ì¡´ê´€ê³„ ì—­ì „ ì›ì¹™
ì¶”ìƒí™”ì— ì˜ì¡´í•´ì•¼ í•˜ê³ , êµ¬ì²´í™”ì— ì˜ì¡´í•˜ë©´ ì•ˆëœë‹¤.

OCP - ê°œë°©-íì‡„ ì›ì¹™
í™•ì¥ì—ëŠ” ì—´ë ¤ìˆìœ¼ë‚˜ ë³€ê²½ì—ëŠ” ë‹«í˜€ìˆì–´ì•¼ í•œë‹¤.

ì„œë¹„ìŠ¤ ê°ì²´ëŠ” ë¹„ì§€ë‹ˆìŠ¤ ë¡œì§ì— ì§‘ì¤‘ í•´ì•¼í•˜ê³ , ìì‹ ì´ ì§ì ‘ ë‚´ë¶€ì— ì–´ë–¤ êµ¬í˜„ì²´ë¥¼ ì„ íƒí• ì§€ ê²°ì •í•˜ë©´ ì•ˆëœë‹¤.

ê·¸ë ‡ë‹¤ë©´ ì–´ë– í•œ ë°©ì‹ìœ¼ë¡œ ì„œë¹„ìŠ¤ ê°ì²´ ë‚´ë¶€ì— ì§ì ‘ ì˜ì¡´ê´€ê³„ë¥¼ ì„¤ì •í•˜ì§€ ì•Šê³  ê°œë°œìì˜ ì˜ë„ëŒ€ë¡œ ì˜ì¡´ê´€ê³„ë¥¼ ì£¼ì…í•  ìˆ˜ ìˆì„ê¹Œ?

ìš°ì„  ì§ì ‘ì ì¸ ì˜ì¡´ì„± ì£¼ì… ì½”ë“œë¥¼ ì‚­ì œ í•´ë³´ë„ë¡ í•˜ì.

    public class MemberServiceImpl implements MemberService {
    
        private MemberRepository memberRepository;
        
        // ì´í•˜ ì„œë¹„ìŠ¤ ë¡œì§

ë‹¤ìŒê³¼ ê°™ì´ ìˆ˜ì •í•˜ê³  í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ì‹¤í–‰í•œë‹¤ë©´ ë‹¹ì—°íˆ `memberRepository` ê°ì²´ë¥¼ ì‚¬ìš©í•  ë•Œ `NullpointerException`ì´ ë°œìƒí•œë‹¤.

ì™œëƒí•˜ë©´ ì•„ë¬´ë„ `memberRepository` ê°ì²´ë¥¼ ì£¼ì…í•´ì£¼ì§€ ì•Šì•˜ê¸° ë•Œë¬¸ì´ë‹¤.

ê·¸ë˜ì„œ ì´ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ ì„¤ì •ìì¸ Config ê°ì²´ì˜ ê°œë…ì´ ë“±ì¥í•˜ê²Œ ëœë‹¤.

ë‹¤ìŒê³¼ ê°™ì€ `MemberConfig` ê°ì²´ë¥¼ ìƒì„±í•œë‹¤.

    public class MemberConfig {
    
        public MemberRepository memberRepository() {
            return new JpaMemberRepository();
        }
    
        public MemberService memberService() {
            return new MemberServiceImpl();
        }
    
    }

Member ë„ë©”ì¸ì— ê´€í•œ ì„¤ì • ê°ì²´ë¥¼ ìƒì„±í•œ í›„ ì˜ì¡´ê´€ê³„ ì£¼ì…ì„ ì´ Config ê°ì²´ì—ê²Œ ì™„ì „íˆ ì¼ì„í•˜ëŠ” ê²ƒì´ë‹¤.

ê·¸ë ‡ë‹¤ë©´ MemberServiceImpl í´ë˜ìŠ¤ ë‚´ë¶€ì˜ ì˜ì¡´ì„±ì€ ë‹¤ìŒê³¼ ê°™ì´ ìƒì„±ìë¥¼ í†µí•´ ì£¼ì…í•  ìˆ˜ ìˆë‹¤.

    public class MemberServiceImpl implements MemberService {
    
        private MemberRepository memberRepository;
    
        public MemberServiceImpl(MemberRepository memberRepository) {
            this.memberRepository = memberRepository;
        }
        
        // ì´í•˜ ì„œë¹„ìŠ¤ ë¡œì§

    class MemberServiceImplTest {
    
        MemberService memberService;
       
        @BeforeEach
        void beforeEach() {
        	//Config ê°ì²´ë¥¼ í†µí•´ ì˜ì¡´ì„±ì„ ì£¼ì…ë°›ëŠ”ë‹¤.
            MemberConfig memberConfig = new MemberConfig();
            this.memberService = memberConfig.memberService();
        }

ì´ë ‡ê²Œ `MemberConfig` ê°ì²´ë¥¼ í†µí•´ ì˜ì¡´ê´€ê³„ë¥¼ ì£¼ì…ë°›ëŠ”ë‹¤ë©´, ì•„ë¬´ë¦¬ `MemberRepository` ì¸í„°í˜ì´ìŠ¤ì— ëŒ€í•œ êµ¬í˜„ì²´ê°€ ë°”ë€Œì–´ë„ `Config` ê°ì²´ ë‚´ë¶€ì—ì„œë§Œ ì˜ì¡´ê´€ê³„ë¥¼ ì„ íƒí•˜ê³ , ì„œë¹„ìŠ¤ ê°ì²´ ë‚´ë¶€ì— ì§ì ‘ ì˜ì¡´ê´€ê³„ë¥¼ ì„ íƒí•  ì¼ì´ ì‚¬ë¼ì§€ê²Œ ëœë‹¤.

ì¦‰, ì˜ì¡´ê´€ê³„ ì„ íƒ ì±…ì„ì„ ì™„ì „íˆ ì¼ì„í•˜ëŠ” ê²ƒì´ë‹¤.

ì´ì²˜ëŸ¼ í”„ë¡œê·¸ë¨(ê°ì²´)ì´ êµ¬í˜„ ê°ì²´ ì œì–´ë¥¼ ì§ì ‘ í•˜ì§€ ì•Šê³ , ì™¸ë¶€ì—ì„œ ê´€ë¦¬í•˜ëŠ” ê²ƒì„ **ì œì–´ì˜ ì—­ì „ IoC(Inversion of Control)** ì´ë¼ê³  í•œë‹¤.

ë˜í•œ MemberConfig ì²˜ëŸ¼ ì œì–´ íë¦„ì— ëŒ€í•œ ê¶Œí•œì„ ê°€ì§€ê³  ìˆëŠ” ì—­í• ì˜ ê°ì²´ë¥¼ **IoC ì»¨í…Œì´ë„ˆ** í˜¹ì€ **DI ì»¨í…Œì´ë„ˆ**ë¼ê³  í•œë‹¤.

ì´ë ‡ê²Œ ì±…ì„ì„ ë¶„ë¦¬í•˜ê²Œ ëœë‹¤ë©´ ë‹¤ìŒê³¼ ê°™ì€ êµ¬ì¡°ê°€ ëœë‹¤.
![](/assets/images/ghost_images/2023/01/image-3.png)DI ì»¨í…Œì´ë„ˆ
ì´ì œ OCP ì›ì¹™ê³¼ DIP ì›ì¹™ì€ ì¤€ìˆ˜í•  ìˆ˜ ìˆê²Œ ë˜ì—ˆì§€ë§Œ, í˜„ì¬ëŠ” ìŠ¤í”„ë§ì˜ ë„ì›€ ì—†ì´ êµ¬í˜„í•˜ì˜€ê¸° ë•Œë¬¸ì— ì‹±ê¸€í†¤ íŒ¨í„´ë„ ì¤€ìˆ˜ë˜ì§€ ì•Šê³  ìˆê³ , ì‚¬ìš©ìê°€ ì¼ì¼íˆ ì˜ì¡´ì„±ì„ ì„¤ì •í•´ì£¼ì–´ì•¼ í•˜ëŠ” ë¬¸ì œê°€ ë‚¨ì•„ìˆë‹¤.

ì‘ì€ ì„œë¹„ìŠ¤ë¼ë„ ìƒë‹¹íˆ ë§ì€ ì¸í„°í˜ì´ìŠ¤ì™€ êµ¬í˜„ì²´ê°€ ìƒì„±ë í…ë° ëª¨ë“  ì˜ì¡´ì„±ì„ ì‚¬ìš©ìê°€ Config ê°ì²´ì— ì§ì ‘ ì£¼ì…í•´ì•¼ í• ê¹Œ?

## 3. ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆ

ê¸°ì¡´ ì†ŒìŠ¤ì—ì„œëŠ” ìš°ë¦¬ê°€ ì§ì ‘ DI ì»¨í…Œì´ë„ˆë¥¼ ì‘ì„±í•˜ì—¬ ìˆ˜ë™ìœ¼ë¡œ ë“±ë¡ëœ ê°ì²´ì˜ ì°¸ì¡°ê°’ì„ ë°›ì•„ì™€ì„œ ì‚¬ìš©í•˜ì˜€ë‹¤.

í•˜ì§€ë§Œ ìŠ¤í”„ë§ì—ì„œ ì§€ì›í•˜ëŠ” ìŠ¤í”„ë§ DI ì»¨í…Œì´ë„ˆ (ì•ìœ¼ë¡œ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆë¼ í•˜ê² ìŒ)ë¥¼ ì‚¬ìš©í•˜ë©´ ì´ëŸ¬í•œ ê°ì²´ë“¤ì„ 'ìŠ¤í”„ë§ ë¹ˆ' ìœ¼ë¡œ ë“±ë¡í•˜ì—¬ ì €ì¥í•´ì£¼ê³  í¸ë¦¬í•˜ê²Œ ê°ì²´ë“¤ì„ ì£¼ì…í•˜ì—¬ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.

ê·¸ë ‡ë‹¤ë©´ ì–´ë–»ê²Œ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì— ë¹ˆ(ê°ì²´)ì„ ë“±ë¡í•  ìˆ˜ ìˆì„ê¹Œ?

Spring Boot ì–´í”Œë¦¬ì¼€ì´ì…˜ì€ ì‹œì‘í•  ë•Œ **ì»´í¬ë„ŒíŠ¸ ìŠ¤ìº”**ì´ë¼ëŠ” ë™ì‘ì´ ì¼ì–´ë‚˜ëŠ”ë° ì´ ë•Œ ìŠ¤í”„ë§ ì• í”Œë¦¬ì¼€ì´ì…˜ ì§€ì • ë²”ìœ„ì— í¬í•¨ëœ ê°ì²´ë“¤ì„ ëª¨ë‘ ìŠ¤ìº”í•˜ì—¬ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì— ë¹ˆìœ¼ë¡œ í¬í•¨ì‹œí‚¨ë‹¤.
![](/assets/images/ghost_images/2023/01/image-4.png)@SpringBootApplication í•˜ìœ„ì— ì»´í¬ë„ŒíŠ¸ ìŠ¤ìº” ì˜µì…˜ì´ ë‚˜ì—´ë˜ì–´ ìˆë‹¤.
ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì— ë¹ˆì„ ë“±ë¡í•˜ëŠ” ë°©ë²•ì€ í¬ê²Œ ë‚˜ëˆ„ìë©´ ìˆ˜ë™ìœ¼ë¡œ ë“±ë¡í•˜ëŠ” ë°©ë²•ê³¼ ìë™ìœ¼ë¡œ ë“±ë¡ ëŒ€ìƒì— í¬í•¨ì‹œí‚¤ëŠ” ë°©ë²•ì´ ìˆë‹¤.

### 3.1 ìˆ˜ë™ ë“±ë¡

ì•ì„œ ì‚´í´ë³¸ Config ê°ì²´, ì¦‰ DI ì»¨í…Œì´ë„ˆë¥¼ í™œìš©í•˜ëŠ” ë°©ë²•ì´ ìˆë‹¤. ì•ì„œ ì‘ì„±í•œ MemberConfig ê°ì²´ì— ë‹¤ìŒê³¼ ê°™ì´ `@Configuration` ì„ ì¶”ê°€í•˜ê³ , ì˜ì¡´ì„±ì„ ë°˜í™˜í•  ë©”ì„œë“œì— `@Bean` ì• ë…¸í…Œì´ì…˜ì„ ì¶”ê°€í•˜ì.

    @Configuration
    public class MemberConfig {
    
        @Bean
        public MemberRepository memberRepository() {
            return new MemoryMemberRepository();
        }
    
        @Bean
        public MemberService memberService() {
            return new MemberServiceImpl(new MemoryMemberRepository());
        }
    
    }

ë‹¤ìŒê³¼ ê°™ì´ `@Configuration` ê³¼ `@Bean` ì• ë…¸í…Œì´ì…˜ì„ í†µí•´ DI ì»¨í…Œì´ë„ˆì™€ ì£¼ì…í•  ê°ì²´ë“¤ì„ ëª…ì‹œì ìœ¼ë¡œ ì§€ì •í•˜ë©´, ìŠ¤í”„ë§ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ê¸°ë™ë˜ë©´ì„œ ìœ„ì—ì„œ ê¸°ìˆ í•œ ì»´í¬ë„ŒíŠ¸ ìŠ¤ìº”ì˜ ìˆ˜ì§‘ ëŒ€ìƒì´ ëœë‹¤.

ê·¸ë ‡ë‹¤ë©´ Cofig ê°ì²´ë¥¼ í†µí•´ ìˆ˜ì§‘í•œ ë¹ˆë“¤ì´ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì— ì˜ ë˜ëŠ”ì§€ ì¡°íšŒí•˜ëŠ” í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ì‘ì„±í•´ë³´ë„ë¡ í•˜ì.

    public class ApplicationContextTest {
    
        AnnotationConfigApplicationContext ac = new AnnotationConfigApplicationContext(MemberConfig.class);
    
        @Test
        @DisplayName("ì „ì²´ ì• í”Œë¦¬ì¼€ì´ì…˜ ë¹ˆ ì¡°íšŒí•˜ê¸°")
        void findAllBeans() {
            String[] beanDefinitionNames = ac.getBeanDefinitionNames();
            for (String beanName : beanDefinitionNames) {
    
                BeanDefinition beanDefinition = ac.getBeanDefinition(beanName);
    
                if (beanDefinition.getRole() == BeanDefinition.ROLE_APPLICATION) {
    
                    Object bean = ac.getBean(beanName);
                    System.out.println("beanName = " + beanName + " | bean = " + bean);
                }
            }
        }
        
        @Test
        @DisplayName("íšŒì› ì„œë¹„ìŠ¤ ë¹ˆ ì°¾ì•„ì˜¤ê¸°")
        void findMemberServiceBean() {
            MemberService memberService = ac.getBean(MemberService.class);
            Assertions.assertThat(memberService).isInstanceOf(MemberServiceImpl.class);
        }
    
        @Test
        @DisplayName("íšŒì› ë¦¬í¬ì§€í† ë¦¬ ë¹ˆ ì°¾ì•„ì˜¤ê¸°")
        void findMemberRepositoryBean() {
            MemberRepository memberRepository = ac.getBean(MemberRepository.class);
            Assertions.assertThat(memberRepository).isInstanceOf(MemoryMemberRepository.class);
        }
    
    }

`AnnotationApplicationContext` ê°ì²´ëŠ” `ApplicationContext` ì˜ êµ¬í˜„ì²´ ì¤‘ í•˜ë‚˜ë¡œ, ìŠ¤í”„ë§ ë¹ˆì˜ ê´€ë¦¬ë¥¼ ìë°”ë¡œ êµ¬í˜„í•˜ëŠ” íƒ€ì…ì˜ êµ¬í˜„ì²´ì´ë‹¤. ê³¼ê±° XML ê´€ë¦¬ ë°©ì‹ ë° Groovy ë“±ì„ ì´ìš©í•˜ëŠ” êµ¬í˜„ì²´ë„ ìˆë‹¤.

ì—„ë°€íˆ ë§í•˜ìë©´ `ApplicationContext` ë³´ë‹¤ ë¹ˆì„ ê´€ë¦¬í•˜ëŠ” `BeanFactory` ê°ì²´ë¥¼ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆë¼ê³  ì •ì˜í•˜ëŠ” ê²ƒì´ ë§ì§€ë§Œ, ìµœê·¼ì—ëŠ” BeanFactory ì—ì„œ êµ­ì œí™” ê¸°ëŠ¥, í™˜ê²½ë³€ìˆ˜, ì• í”Œë¦¬ì¼€ì´ì…˜ ì´ë²¤íŠ¸, í¸ë¦¬í•œ ë¦¬ì†ŒìŠ¤ ì¡°íšŒ ë“± ì—¬ëŸ¬ ê¸°ëŠ¥ì„ ë§ë¶™ì¸ ApplicationContext ê°ì²´ë¥¼ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆë¼ê³  ë¶€ë¥¸ë‹¤.

ì†ŒìŠ¤ì— ëŒ€í•œ ì„¤ëª…ìœ¼ë¡œ ëŒì•„ê°€ìë©´, ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì—ì„œ ì „ì²´ ë“±ë¡ëœ ìŠ¤í”„ë§ ë¹ˆì„ ê°€ì ¸ì™€ì„œ ì‚¬ìš©ìê°€ ì§ì ‘ ë“±ë¡í•œ ê°ì²´ (ROLE_APPLICATION) ë“¤ë§Œ ì •ë¦¬í•˜ì—¬ ì¶œë ¥í•œë‹¤. `BeanDefinition`ì€ ê°ì²´ì˜ ë©”íƒ€ë°ì´í„°ë¥¼ í¬í•¨í•˜ê³  ìˆëŠ” ê°ì²´ì´ë‹¤.
![](/assets/images/ghost_images/2023/01/image-5.png)ì „ì²´ í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ê²°ê³¼
ì‹¤í–‰ ê²°ê³¼ë¥¼ ë³´ë©´ Config ê°ì²´ë¥¼ í¬í•¨í•˜ì—¬ Beanìœ¼ë¡œ ë“±ë¡í•œ ê°ì²´ë“¤ì´ ì˜ ì¶œë ¥ ë˜ê³ , ì§ì ‘ ì§€ì •í•œ ê°ì²´ ë°˜í™˜ íƒ€ì…ì´ ì¶œë ¥ë˜ê³  ìˆëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

### 3.2 ìë™ ë“±ë¡

ìŠ¤í”„ë§ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì‹œì‘í•˜ë©´ì„œ ì»´í¬ë„ŒíŠ¸ ìŠ¤ìº”ì„ í†µí•´ ê°ì²´ë“¤ì„ ìˆ˜ì§‘í•˜ê³  ìŠ¤í”„ë§ ë¹ˆìœ¼ë¡œì¨ ìë™ìœ¼ë¡œ ì €ì¥í•œë‹¤ê³  ì•ì„œ ì„¤ëª…í•œ ë°” ìˆë‹¤.

ê·¸ë ‡ë‹¤ë©´ ìë™ìœ¼ë¡œ ë¹ˆìœ¼ë¡œ ìˆ˜ì§‘ë˜ëŠ” ê°ì²´ë“¤ì€ ì–´ë– í•œ ê°ì²´ë“¤ì¼ê¹Œ?

ì‚¬ì‹¤ì€ ìœ„ì—ì„œ ìˆ˜ë™ ë“±ë¡ì„ í…ŒìŠ¤íŠ¸í•˜ë©° í•œ ê°€ì§€ ìë™ ë“±ë¡ì˜ ì˜ˆë¥¼ ì´ë¯¸ ì‚´í´ë³´ì•˜ë‹¤. ë°”ë¡œ `@Configuration` ì• ë…¸í…Œì´ì…˜ì´ ë¶™ì€ ì„¤ì • ê°ì²´ì´ë‹¤.

ìŠ¤í”„ë§ì—ì„œëŠ” ìì£¼ ì“°ëŠ” ê°ì²´ë“¤ ëª‡ ê°€ì§€ë¥¼ ëŒ€ìƒìœ¼ë¡œ í•˜ëŠ” ì• ë…¸í…Œì´ì…˜ì´ ì¡´ì¬í•˜ëŠ”ë° ì´ ì• ë…¸í…Œì´ì…˜ë“¤ì„ ìŠ¤í”„ë§ì´ ê¸°ë™í•˜ë©° ìë™ìœ¼ë¡œ ìˆ˜ì§‘í•œë‹¤.

ëŒ€í‘œì ì¸ ì˜ˆë¡œëŠ” `@Configuration` , `@Controller` , `@Service` , `@Repository` ë“±ì´ ìˆë‹¤.

ì´ë“¤ì€ ëª¨ë‘ `@Component` ì• ë…¸í…Œì´ì…˜ì„ ìƒì†ë°›ëŠ”ë°, ê²°êµ­ `@Component` ì• ë…¸í…Œì´ì…˜ì´ ë¶™ì€ ê°ì²´ë¥¼ ëª¨ë‘ ìˆ˜ì§‘í•˜ë‹¤ê³  ì •ë¦¬í•  ìˆ˜ ìˆë‹¤.
![](/assets/images/ghost_images/2023/01/image-6.png)Configuration ì• ë…¸í…Œì´ì…˜ ë‚´ë¶€
> ì• ë…¸í…Œì´ì…˜ì˜ ìƒì†ì€ ê³µì‹ì ì¸ ìë°” ë¬¸ë²•ì´ ì•„ë‹ˆê³ , ìŠ¤í”„ë§ì´ í¸ì˜ìƒ ì œê³µí•˜ëŠ” ê¸°ëŠ¥ì´ë‹¤.

ì›ë˜ë¼ë©´ ìŠ¤í”„ë§ì´ ê¸°ë™ë˜ë©´ì„œ ì»´í¬ë„ŒíŠ¸ ìŠ¤ìº”ì´ í•œë²ˆ ì´ë£¨ì–´ì§€ì§€ë§Œ, ìš°ë¦¬ëŠ” í…ŒìŠ¤íŠ¸ í™˜ê²½ì—ì„œ ì»´í¬ë„ŒíŠ¸ ìŠ¤ìº”ì„ ìˆ˜ë™ìœ¼ë¡œ ì‹¤í–‰í•´ ì£¼ì–´ì•¼ í•˜ê¸° ë•Œë¬¸ì— ë³„ë„ì˜ ì„¤ì • í™˜ê²½ì„ ë§Œë“¤ì–´ ë³´ì.

    @Configuration
    @ComponentScan(
            basePackages = "jwjung.spring.remind",
            excludeFilters = @ComponentScan.Filter(
            	type = FilterType.ANNOTATION, classes = Configuration.class
            )
    )
    public class MemberAutoConfig {
    }

    @Repository
    public class MemoryMemberRepository implements MemberRepository {
    // ì´í•˜ ìƒëµ

    @Service
    public class MemberServiceImpl implements MemberService {
    // ì´í•˜ ìƒëµ

ì»´í¬ë„ŒíŠ¸ ìŠ¤ìº”ë§Œì„ ëª…ì‹œí•˜ëŠ” Config ê°ì²´ë¥¼ ìƒì„±í•˜ê³  ìŠ¤ìº”ì˜ ëŒ€ìƒì´ ë  ê°ì²´ë“¤ì— ë‹¤ìŒê³¼ ê°™ì´ `@Component`ì˜ í•˜ìœ„ ì• ë…¸í…Œì´ì…˜ì„ ë¶™ì—¬ì¤€ë‹¤.

ê·¸ë¦¬ê³  ì•„ê¹Œ í–ˆë˜ í…ŒìŠ¤íŠ¸ì™€ ë¹„ìŠ·í•˜ê²Œ í…ŒìŠ¤íŠ¸ë¥¼ ì‘ì„±í•´ë³´ì.

    public class ComponentScanTest {
    
        AnnotationConfigApplicationContext ac = 
        	new AnnotationConfigApplicationContext(MemberAutoConfig.class);
    
        @Test
        @DisplayName("ì „ì²´ ì• í”Œë¦¬ì¼€ì´ì…˜ ë¹ˆ ì¡°íšŒí•˜ê¸°")
        void findAllBeans() {
            String[] beanDefinitionNames = ac.getBeanDefinitionNames();
            for (String beanName : beanDefinitionNames) {
    
                BeanDefinition beanDefinition = ac.getBeanDefinition(beanName);
    
                if (beanDefinition.getRole() == BeanDefinition.ROLE_APPLICATION) {
    
                    Object bean = ac.getBean(beanName);
                    System.out.println("beanName = " + beanName + " | bean = " + bean);
                }
            }
        }
    }

![](/assets/images/ghost_images/2023/01/image-7.png)í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ê²°ê³¼
ë¶„ëª… `Config` ê°ì²´ ë‚´ì— ëª…ì‹œí•œ ìŠ¤í”„ë§ ë¹ˆì´ ì—†ìŒì—ë„ ë¶ˆêµ¬í•˜ê³  Service ê°ì²´ì™€ `Repository` ê°ì²´ê°€ ìŠ¤í”„ë§ ë¹ˆìœ¼ë¡œ ì»¨í…Œì´ë„ˆ ì•ˆì— ì €ì¥ë˜ì–´ ìˆìŒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

ì´ë¥¼ í†µí•´ ì–´ë–»ê²Œ ì—¬íƒœê¹Œì§€ ì¼ì¼íˆ ëª…ì‹œì ì¸ DIë¥¼ ì§€ì •í•˜ì§€ ì•Šì•„ë„ ì˜ì¡´ì„±ì´ ì£¼ì…ë˜ì–´ ì™”ëŠ”ì§€ë¥¼ ì•Œì•„ë³´ì•˜ë‹¤.

ê·¸ë ‡ë‹¤ë©´ í˜¹ì‹œ ê°™ì€ ë¶€ëª¨ ì¸í„°í˜ì´ìŠ¤ë¥¼ ìƒì†ë°›ëŠ” êµ¬í˜„ì²´ ë‘ê°œê°€ ëª¨ë‘ ì»´í¬ë„ŒíŠ¸ë¡œ ë“±ë¡ë˜ì–´ ìˆë‹¤ë©´, ìŠ¤í”„ë§ì´ `MemberServiceImpl` ì— ì£¼ì…í•  ê°ì²´ë¥¼ ì–´ë–»ê²Œ íŒë‹¨í•  ìˆ˜ ìˆì„ê¹Œ?

`MemberRepository`ë¥¼ ìƒì†ë°›ëŠ” `MemoryMemberRepository` ì™€ `JpaMemberRepository` ì–‘ìª½ì— ëª¨ë‘ `@Repository` ì• ë…¸í…Œì´ì…˜ì„ ë¶™ì´ê³  ê°™ì€ í…ŒìŠ¤íŠ¸ ë©”ì„œë“œë¥¼ ì‹¤í–‰í•´ë³´ì.
![](/assets/images/ghost_images/2023/01/image-8.png)
ë‹¤ìŒê³¼ ê°™ì€ ì¹œì ˆí•œ ì—ëŸ¬ ë¬¸êµ¬ë¥¼ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

No qualifying bean of type 'jwjung.spring.remind.repository.MemberRepository' available: expected single matching bean but found 2: jpaMemberRepository,memoryMemberRepository

`MemberServiceImpl` ê°ì²´ì— ì£¼ì…í•´ì•¼ í•  ì˜ì¡´ì„±ì„ ìŠ¤í”„ë§ì´ íŒë‹¨ í•  ìˆ˜ê°€ ì—†ìœ¼ë¯€ë¡œ `NoUniqueBeanDefinitionException` ëŸ°íƒ€ì„ ì˜ˆì™¸ê°€ ë°œìƒí•œë‹¤.

ì´ëŸ´ë•Œ ë‘ê°€ì§€ ë°©ë²•ì„ í†µí•´ ê°ì²´ ì£¼ì… ì„ íƒê¶Œì„ ê²°ì •í•  ìˆ˜ ìˆëŠ”ë°, ì²«ë²ˆì§¸ëŠ” `@Primary` ì• ë…¸í…Œì´ì…˜ì„ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ê³¼, `@Qualifer` ì• ë…¸í…Œì´ì…˜ì„ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ì´ë‹¤.

`@Primary` ì• ë…¸í…Œì´ì…˜ì„ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ì€ ì• ë§¤í•œ ìƒí™©ì˜ ì—¬ëŸ¬ ê°€ì§€ êµ¬í˜„ì²´ì¤‘, ì‹¤ì œë¡œ ì£¼ì…ë°›ì„ ê°ì²´ ìœ„ì— `@Primary` ì• ë…¸í…Œì´ì…˜ì„ ë¶™ì—¬ì£¼ëŠ” ê²ƒì´ë‹¤.

    @Repository
    @Primary
    public class MemoryMemberRepository implements MemberRepository {
    // ì´í•˜ ìƒëµ

ë˜ í•œê°€ì§€ `@Qualifer` ì• ë…¸í…Œì´ì…˜ì„ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ì€, ê° êµ¬í˜„ì²´ì— `@Qualifer` ì• ë…¸í…Œì´ì…˜ìœ¼ë¡œ ëª…ì¹­ì„ ëª…ì‹œí•˜ê³ , ì‹¤ì œë¡œ ì£¼ì…ë°›ëŠ” ê°ì²´ì—ë„ ì£¼ì…ë°›ëŠ” ëŒ€ìƒì˜ `@Qualifer` ì• ë…¸í…Œì´ì…˜ì„ ì¼ì¹˜ì‹œì¼œì£¼ë©´ ëœë‹¤.

    @Repository
    @Qualifier("memoryMemberRepository")
    public class MemoryMemberRepository implements MemberRepository {
    // ì´í•˜ ìƒëµ

    @Repository
    @Qualifier("jpaMemberRepository")
    public class JpaMemberRepository implements MemberRepository {
    // ì´í•˜ ìƒëµ

    @Service
    public class MemberServiceImpl implements MemberService {
    
        private MemberRepository memberRepository;
    
        public MemberServiceImpl(@Qualifier("memoryMemberRepository") 
        	MemberRepository memberRepository) {
            this.memberRepository = memberRepository;
        }
        
        // ì´í•˜ ìƒëµ

## 4. ë§ˆë¬´ë¦¬

ì§€ê¸ˆê¹Œì§€ ê°ì²´ì§€í–¥ì ì¸ ì„¤ê³„ë¥¼ ë„ì™€ì£¼ëŠ” ìŠ¤í”„ë§ì˜ ë¹ˆ ê´€ë ¨ ê¸°ëŠ¥ì„ ìˆœì°¨ì ìœ¼ë¡œ ì•Œì•„ë³´ì•˜ë‹¤.

ë‹¨ìˆœíˆ ìŠ¤í”„ë§ì´ ì œê³µí•˜ëŠ” ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ê¸°ë§Œ í•˜ë‹¤ê°€ ë¬´ìŠ¨ ì´ìœ ë¡œ ì´ëŸ¬í•œ ê¸°ëŠ¥ë“¤ì„ ì œê³µí•˜ê¸°ì— ì´ë¥´ë €ëŠ”ì§€ í•œë²ˆ ê³µë¶€í•´ë³´ëŠ” ìœ ìµí•œ ì‹œê°„ì´ì—ˆë‹¤.
