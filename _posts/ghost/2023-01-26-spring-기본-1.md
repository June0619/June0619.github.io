---
title: [Spring] μ¤ν”„λ§ κΈ°λ³Έ 1 - DIP, OCP μ›μΉ™κ³Ό μ¤ν”„λ§ μ»¨ν…μ΄λ„
slug: spring-κΈ°λ³Έ-1
date_published: 2023-01-26T02:05:19.000Z
date_updated: 2023-02-02T01:22:58.000Z
tags: κ³µλ¶€, Spring
---

π’΅

ν•΄λ‹Ή μ‹λ¦¬μ¦λ” μΈν”„λ°μ κΉ€μν• κ°•μ‚¬λ‹ [[λ§ν¬]'μ¤ν”„λ§ ν•µμ‹¬μ›λ¦¬ - κΈ°λ³ΈνΈ' ](https://inf.run/n6jw) κ°•μ λ‚΄μ© λ³µμµμ„ μ„ν•΄ λ‚΄μ©κ³Ό μ†μ¤λ¥Ό μ¬κµ¬μ„±ν•μ—¬ μ‘μ„±ν•μ€μµλ‹λ‹¤.
1. **μ¤ν”„λ§ κΈ°λ³Έ 1 - DIP, OCP μ›μΉ™κ³Ό μ¤ν”„λ§ μ»¨ν…μ΄λ„**
2. [μ¤ν”„λ§ κΈ°λ³Έ 2 - μ‹±κΈ€ν†¤ ν¨ν„΄κ³Ό μ‹±κΈ€ν†¤ μ»¨ν…μ΄λ„](__GHOST_URL__/spring-%EA%B8%B0%EB%B3%B8-2/)
3. [μ¤ν”„λ§ κΈ°λ³Έ 3 - λΉ μ¤μ½”ν”„μ™€ μƒλ…μ£ΌκΈ°](__GHOST_URL__/spring-%EA%B8%B0%EB%B3%B8-3)

## 1. κ°μ”

λ°μ΄ν„°λ² μ΄μ¤κ°€ μ •ν•΄μ§€μ§€ μ•μ•„μ„ μ„μ‹ λ©”λ¨λ¦¬ μ €μ¥μ†λ¥Ό κµ¬ν„ν•΄μ„ κ°λ°ν•λ μ¤‘, DBκ°€ ν™•μ •λκ³  JPAλ΅ λ ν¬μ§€ν„°λ¦¬ λ μ΄μ–΄λ¥Ό κµ¬ν„ν•λ‹¤κ³  κ°€μ •ν•λ‹¤. DI μ»¨ν…μ΄λ„, νΉμ€ μ¤ν”„λ§ μ»¨ν…μ΄λ„μ— λ€ν•΄ κ³µλ¶€ν•κΈ° μ „μ—λ” μμ΅΄κ΄€κ³„λ¥Ό μ§μ ‘ κµ¬ν„μ²΄λ¥Ό μ„¤μ •ν•μ—¬ μ§€μ •ν•΄ μ£Όμ—μ§€λ§, μ΄λ” SOLID 5μ›μΉ™ μ¤‘ DIP, OCPμ— μ„λ°°λλ” λ°©μ‹μ΄λ‹¤. κ·Έλ ‡λ‹¤λ©΄ κ°μ²΄μ§€ν–¥μ μΈ μ„¤κ³„λ¥Ό μ„ν•΄μ„λ” μ–΄λ–»κ² ν•΄μ•Ό ν• κΉ?
![](__GHOST_URL__/content/images/2023/01/image-1.png)λ³€κ²½ μ „![](__GHOST_URL__/content/images/2023/01/image-2.png)λ³€κ²½ ν›„
## 2. μ¤ν”„λ§μ΄ μ—†λ‹¤κ³  κ°€μ •ν•λ©΄

λ¨Όμ € μ°λ¦¬κ°€ μµμΆ…μ μΌλ΅ μ„±κ³µν•΄μ•Ό ν•λ” ν…μ¤νΈ μ½”λ“λ¥Ό λ¨Όμ € μ‘μ„± ν•΄λ³΄μ.

    class MemberServiceImplTest {
    	
        //μ•„μ§ λ³„λ‹¤λ¥Έ DI μ»¨ν…μ΄λ„κ°€ μ—†μΌλ―€λ΅ 
        //μ„λΉ„μ¤ κ°μ²΄λ„ μ§μ ‘ μƒμ„±ν•μ—¬ μ£Όμ…ν•λ„λ΅ ν•λ‹¤.
        MemberService memberService = new MemberServiceImpl();
    
        @Test
        @DisplayName("νμ›κ°€μ… μ„±κ³µ")
        void join() {
            //given
            Member member = new Member("name", MemberGrade.USER);
    
            //when
            Long joinedId = memberService.join(member);
    
            //then
            Member findMember = memberService.findOne(joinedId).get();
            Assertions.assertThat(findMember.getId()).isEqualTo(member.getId());
            Assertions.assertThat(findMember.getGrade())
            	.isEqualTo(member.getGrade());
        }
    
    }

λ§μ•½ μ¤ν”„λ§μ κΈ°λ¥μ΄ μ—†μ΄ κµ¬ν„μ²΄λ¥Ό μ„¤μ •ν•λ‹¤κ³  ν•λ©΄ λ‹¤μκ³Ό κ°™μ΄ λ‹¤ν•μ„±μ„ μ΄μ©ν•΄λ³Ό μ μλ‹¤.

    public class MemberServiceImpl implements MemberService {
    
    	//private MemberRepository memberRepository = new MemoryMemberRepository();
        private MemberRepository memberRepository = new JpaMemberRepository();
        
        // μ΄ν• μ„λΉ„μ¤ λ΅μ§

λ‹¤μκ³Ό κ°™μ΄ μμ΅΄μ„±μ„ μ§μ ‘ μμ •ν•΄ μ£Όμ—λ‹¤λ©΄ ν…μ¤νΈ μ½”λ“λ„ μ ν†µκ³Όν•  κ²ƒμ΄λ‹¤.

ν•μ§€λ§ μ„μ™€ κ°™μ€ μ½”λ“λ” μ‚¬μ‹¤ μ„μ—μ„ μ„μ ν–λ“― DIP, OCP μ›μΉ™μ— μ„λ°°λλ‹¤.

βοΈ

DIP - μμ΅΄κ΄€κ³„ μ—­μ „ μ›μΉ™
μ¶”μƒν™”μ— μμ΅΄ν•΄μ•Ό ν•κ³ , κµ¬μ²΄ν™”μ— μμ΅΄ν•λ©΄ μ•λλ‹¤.

OCP - κ°λ°©-νμ‡„ μ›μΉ™
ν™•μ¥μ—λ” μ—΄λ ¤μμΌλ‚ λ³€κ²½μ—λ” λ‹«ν€μμ–΄μ•Ό ν•λ‹¤.

μ„λΉ„μ¤ κ°μ²΄λ” λΉ„μ§€λ‹μ¤ λ΅μ§μ— μ§‘μ¤‘ ν•΄μ•Όν•κ³ , μμ‹ μ΄ μ§μ ‘ λ‚΄λ¶€μ— μ–΄λ–¤ κµ¬ν„μ²΄λ¥Ό μ„ νƒν• μ§€ κ²°μ •ν•λ©΄ μ•λλ‹¤.

κ·Έλ ‡λ‹¤λ©΄ μ–΄λ– ν• λ°©μ‹μΌλ΅ μ„λΉ„μ¤ κ°μ²΄ λ‚΄λ¶€μ— μ§μ ‘ μμ΅΄κ΄€κ³„λ¥Ό μ„¤μ •ν•μ§€ μ•κ³  κ°λ°μμ μλ„λ€λ΅ μμ΅΄κ΄€κ³„λ¥Ό μ£Όμ…ν•  μ μμ„κΉ?

μ°μ„  μ§μ ‘μ μΈ μμ΅΄μ„± μ£Όμ… μ½”λ“λ¥Ό μ‚­μ  ν•΄λ³΄λ„λ΅ ν•μ.

    public class MemberServiceImpl implements MemberService {
    
        private MemberRepository memberRepository;
        
        // μ΄ν• μ„λΉ„μ¤ λ΅μ§

λ‹¤μκ³Ό κ°™μ΄ μμ •ν•κ³  ν…μ¤νΈ μ½”λ“λ¥Ό μ‹¤ν–‰ν•λ‹¤λ©΄ λ‹Ήμ—°ν `memberRepository` κ°μ²΄λ¥Ό μ‚¬μ©ν•  λ• `NullpointerException`μ΄ λ°μƒν•λ‹¤.

μ™λƒν•λ©΄ μ•„λ¬΄λ„ `memberRepository` κ°μ²΄λ¥Ό μ£Όμ…ν•΄μ£Όμ§€ μ•μ•κΈ° λ•λ¬Έμ΄λ‹¤.

κ·Έλμ„ μ΄λ¥Ό ν•΄κ²°ν•κΈ° μ„ν•΄ μ„¤μ •μμΈ Config κ°μ²΄μ κ°λ…μ΄ λ“±μ¥ν•κ² λλ‹¤.

λ‹¤μκ³Ό κ°™μ€ `MemberConfig` κ°μ²΄λ¥Ό μƒμ„±ν•λ‹¤.

    public class MemberConfig {
    
        public MemberRepository memberRepository() {
            return new JpaMemberRepository();
        }
    
        public MemberService memberService() {
            return new MemberServiceImpl();
        }
    
    }

Member λ„λ©”μΈμ— κ΄€ν• μ„¤μ • κ°μ²΄λ¥Ό μƒμ„±ν• ν›„ μμ΅΄κ΄€κ³„ μ£Όμ…μ„ μ΄ Config κ°μ²΄μ—κ² μ™„μ „ν μΌμ„ν•λ” κ²ƒμ΄λ‹¤.

κ·Έλ ‡λ‹¤λ©΄ MemberServiceImpl ν΄λμ¤ λ‚΄λ¶€μ μμ΅΄μ„±μ€ λ‹¤μκ³Ό κ°™μ΄ μƒμ„±μλ¥Ό ν†µν•΄ μ£Όμ…ν•  μ μλ‹¤.

    public class MemberServiceImpl implements MemberService {
    
        private MemberRepository memberRepository;
    
        public MemberServiceImpl(MemberRepository memberRepository) {
            this.memberRepository = memberRepository;
        }
        
        // μ΄ν• μ„λΉ„μ¤ λ΅μ§

    class MemberServiceImplTest {
    
        MemberService memberService;
       
        @BeforeEach
        void beforeEach() {
        	//Config κ°μ²΄λ¥Ό ν†µν•΄ μμ΅΄μ„±μ„ μ£Όμ…λ°›λ”λ‹¤.
            MemberConfig memberConfig = new MemberConfig();
            this.memberService = memberConfig.memberService();
        }

μ΄λ ‡κ² `MemberConfig` κ°μ²΄λ¥Ό ν†µν•΄ μμ΅΄κ΄€κ³„λ¥Ό μ£Όμ…λ°›λ”λ‹¤λ©΄, μ•„λ¬΄λ¦¬ `MemberRepository` μΈν„°νμ΄μ¤μ— λ€ν• κµ¬ν„μ²΄κ°€ λ°”λ€μ–΄λ„ `Config` κ°μ²΄ λ‚΄λ¶€μ—μ„λ§ μμ΅΄κ΄€κ³„λ¥Ό μ„ νƒν•κ³ , μ„λΉ„μ¤ κ°μ²΄ λ‚΄λ¶€μ— μ§μ ‘ μμ΅΄κ΄€κ³„λ¥Ό μ„ νƒν•  μΌμ΄ μ‚¬λΌμ§€κ² λλ‹¤.

μ¦‰, μμ΅΄κ΄€κ³„ μ„ νƒ μ±…μ„μ„ μ™„μ „ν μΌμ„ν•λ” κ²ƒμ΄λ‹¤.

μ΄μ²λΌ ν”„λ΅κ·Έλ¨(κ°μ²΄)μ΄ κµ¬ν„ κ°μ²΄ μ μ–΄λ¥Ό μ§μ ‘ ν•μ§€ μ•κ³ , μ™Έλ¶€μ—μ„ κ΄€λ¦¬ν•λ” κ²ƒμ„ **μ μ–΄μ μ—­μ „ IoC(Inversion of Control)** μ΄λΌκ³  ν•λ‹¤.

λν• MemberConfig μ²λΌ μ μ–΄ νλ¦„μ— λ€ν• κ¶ν•μ„ κ°€μ§€κ³  μλ” μ—­ν• μ κ°μ²΄λ¥Ό **IoC μ»¨ν…μ΄λ„** νΉμ€ **DI μ»¨ν…μ΄λ„**λΌκ³  ν•λ‹¤.

μ΄λ ‡κ² μ±…μ„μ„ λ¶„λ¦¬ν•κ² λλ‹¤λ©΄ λ‹¤μκ³Ό κ°™μ€ κµ¬μ΅°κ°€ λλ‹¤.
![](__GHOST_URL__/content/images/2023/01/image-3.png)DI μ»¨ν…μ΄λ„
μ΄μ  OCP μ›μΉ™κ³Ό DIP μ›μΉ™μ€ μ¤€μν•  μ μκ² λμ—μ§€λ§, ν„μ¬λ” μ¤ν”„λ§μ λ„μ›€ μ—†μ΄ κµ¬ν„ν•μ€κΈ° λ•λ¬Έμ— μ‹±κΈ€ν†¤ ν¨ν„΄λ„ μ¤€μλμ§€ μ•κ³  μκ³ , μ‚¬μ©μκ°€ μΌμΌν μμ΅΄μ„±μ„ μ„¤μ •ν•΄μ£Όμ–΄μ•Ό ν•λ” λ¬Έμ κ°€ λ‚¨μ•„μλ‹¤.

μ‘μ€ μ„λΉ„μ¤λΌλ„ μƒλ‹Ήν λ§μ€ μΈν„°νμ΄μ¤μ™€ κµ¬ν„μ²΄κ°€ μƒμ„±λ ν…λ° λ¨λ“  μμ΅΄μ„±μ„ μ‚¬μ©μκ°€ Config κ°μ²΄μ— μ§μ ‘ μ£Όμ…ν•΄μ•Ό ν• κΉ?

## 3. μ¤ν”„λ§ μ»¨ν…μ΄λ„

κΈ°μ΅΄ μ†μ¤μ—μ„λ” μ°λ¦¬κ°€ μ§μ ‘ DI μ»¨ν…μ΄λ„λ¥Ό μ‘μ„±ν•μ—¬ μλ™μΌλ΅ λ“±λ΅λ κ°μ²΄μ μ°Έμ΅°κ°’μ„ λ°›μ•„μ™€μ„ μ‚¬μ©ν•μ€λ‹¤.

ν•μ§€λ§ μ¤ν”„λ§μ—μ„ μ§€μ›ν•λ” μ¤ν”„λ§ DI μ»¨ν…μ΄λ„ (μ•μΌλ΅ μ¤ν”„λ§ μ»¨ν…μ΄λ„λΌ ν•κ² μ)λ¥Ό μ‚¬μ©ν•λ©΄ μ΄λ¬ν• κ°μ²΄λ“¤μ„ 'μ¤ν”„λ§ λΉ' μΌλ΅ λ“±λ΅ν•μ—¬ μ €μ¥ν•΄μ£Όκ³  νΈλ¦¬ν•κ² κ°μ²΄λ“¤μ„ μ£Όμ…ν•μ—¬ μ‚¬μ©ν•  μ μλ‹¤.

κ·Έλ ‡λ‹¤λ©΄ μ–΄λ–»κ² μ¤ν”„λ§ μ»¨ν…μ΄λ„μ— λΉ(κ°μ²΄)μ„ λ“±λ΅ν•  μ μμ„κΉ?

Spring Boot μ–΄ν”λ¦¬μΌ€μ΄μ…μ€ μ‹μ‘ν•  λ• **μ»΄ν¬λ„νΈ μ¤μΊ”**μ΄λΌλ” λ™μ‘μ΄ μΌμ–΄λ‚λ”λ° μ΄ λ• μ¤ν”„λ§ μ• ν”λ¦¬μΌ€μ΄μ… μ§€μ • λ²”μ„μ— ν¬ν•¨λ κ°μ²΄λ“¤μ„ λ¨λ‘ μ¤μΊ”ν•μ—¬ μ¤ν”„λ§ μ»¨ν…μ΄λ„μ— λΉμΌλ΅ ν¬ν•¨μ‹ν‚¨λ‹¤.
![](__GHOST_URL__/content/images/2023/01/image-4.png)@SpringBootApplication ν•μ„μ— μ»΄ν¬λ„νΈ μ¤μΊ” μµμ…μ΄ λ‚μ—΄λμ–΄ μλ‹¤.
μ¤ν”„λ§ μ»¨ν…μ΄λ„μ— λΉμ„ λ“±λ΅ν•λ” λ°©λ²•μ€ ν¬κ² λ‚λ„μλ©΄ μλ™μΌλ΅ λ“±λ΅ν•λ” λ°©λ²•κ³Ό μλ™μΌλ΅ λ“±λ΅ λ€μƒμ— ν¬ν•¨μ‹ν‚¤λ” λ°©λ²•μ΄ μλ‹¤.

### 3.1 μλ™ λ“±λ΅

μ•μ„ μ‚΄ν΄λ³Έ Config κ°μ²΄, μ¦‰ DI μ»¨ν…μ΄λ„λ¥Ό ν™μ©ν•λ” λ°©λ²•μ΄ μλ‹¤. μ•μ„ μ‘μ„±ν• MemberConfig κ°μ²΄μ— λ‹¤μκ³Ό κ°™μ΄ `@Configuration` μ„ μ¶”κ°€ν•κ³ , μμ΅΄μ„±μ„ λ°ν™ν•  λ©”μ„λ“μ— `@Bean` μ• λ…Έν…μ΄μ…μ„ μ¶”κ°€ν•μ.

    @Configuration
    public class MemberConfig {
    
        @Bean
        public MemberRepository memberRepository() {
            return new MemoryMemberRepository();
        }
    
        @Bean
        public MemberService memberService() {
            return new MemberServiceImpl(new MemoryMemberRepository());
        }
    
    }

λ‹¤μκ³Ό κ°™μ΄ `@Configuration` κ³Ό `@Bean` μ• λ…Έν…μ΄μ…μ„ ν†µν•΄ DI μ»¨ν…μ΄λ„μ™€ μ£Όμ…ν•  κ°μ²΄λ“¤μ„ λ…μ‹μ μΌλ΅ μ§€μ •ν•λ©΄, μ¤ν”„λ§ μ• ν”λ¦¬μΌ€μ΄μ…μ΄ κΈ°λ™λλ©΄μ„ μ„μ—μ„ κΈ°μ ν• μ»΄ν¬λ„νΈ μ¤μΊ”μ μμ§‘ λ€μƒμ΄ λλ‹¤.

κ·Έλ ‡λ‹¤λ©΄ Cofig κ°μ²΄λ¥Ό ν†µν•΄ μμ§‘ν• λΉλ“¤μ΄ μ¤ν”„λ§ μ»¨ν…μ΄λ„μ— μ λλ”μ§€ μ΅°νν•λ” ν…μ¤νΈ μ½”λ“λ¥Ό μ‘μ„±ν•΄λ³΄λ„λ΅ ν•μ.

    public class ApplicationContextTest {
    
        AnnotationConfigApplicationContext ac = new AnnotationConfigApplicationContext(MemberConfig.class);
    
        @Test
        @DisplayName("μ „μ²΄ μ• ν”λ¦¬μΌ€μ΄μ… λΉ μ΅°νν•κΈ°")
        void findAllBeans() {
            String[] beanDefinitionNames = ac.getBeanDefinitionNames();
            for (String beanName : beanDefinitionNames) {
    
                BeanDefinition beanDefinition = ac.getBeanDefinition(beanName);
    
                if (beanDefinition.getRole() == BeanDefinition.ROLE_APPLICATION) {
    
                    Object bean = ac.getBean(beanName);
                    System.out.println("beanName = " + beanName + " | bean = " + bean);
                }
            }
        }
        
        @Test
        @DisplayName("νμ› μ„λΉ„μ¤ λΉ μ°Ύμ•„μ¤κΈ°")
        void findMemberServiceBean() {
            MemberService memberService = ac.getBean(MemberService.class);
            Assertions.assertThat(memberService).isInstanceOf(MemberServiceImpl.class);
        }
    
        @Test
        @DisplayName("νμ› λ¦¬ν¬μ§€ν† λ¦¬ λΉ μ°Ύμ•„μ¤κΈ°")
        void findMemberRepositoryBean() {
            MemberRepository memberRepository = ac.getBean(MemberRepository.class);
            Assertions.assertThat(memberRepository).isInstanceOf(MemoryMemberRepository.class);
        }
    
    }

`AnnotationApplicationContext` κ°μ²΄λ” `ApplicationContext` μ κµ¬ν„μ²΄ μ¤‘ ν•λ‚λ΅, μ¤ν”„λ§ λΉμ κ΄€λ¦¬λ¥Ό μλ°”λ΅ κµ¬ν„ν•λ” νƒ€μ…μ κµ¬ν„μ²΄μ΄λ‹¤. κ³Όκ±° XML κ΄€λ¦¬ λ°©μ‹ λ° Groovy λ“±μ„ μ΄μ©ν•λ” κµ¬ν„μ²΄λ„ μλ‹¤.

μ—„λ°€ν λ§ν•μλ©΄ `ApplicationContext` λ³΄λ‹¤ λΉμ„ κ΄€λ¦¬ν•λ” `BeanFactory` κ°μ²΄λ¥Ό μ¤ν”„λ§ μ»¨ν…μ΄λ„λΌκ³  μ •μν•λ” κ²ƒμ΄ λ§μ§€λ§, μµκ·Όμ—λ” BeanFactory μ—μ„ κµ­μ ν™” κΈ°λ¥, ν™κ²½λ³€μ, μ• ν”λ¦¬μΌ€μ΄μ… μ΄λ²¤νΈ, νΈλ¦¬ν• λ¦¬μ†μ¤ μ΅°ν λ“± μ—¬λ¬ κΈ°λ¥μ„ λ§λ¶™μΈ ApplicationContext κ°μ²΄λ¥Ό μ¤ν”„λ§ μ»¨ν…μ΄λ„λΌκ³  λ¶€λ¥Έλ‹¤.

μ†μ¤μ— λ€ν• μ„¤λ…μΌλ΅ λμ•„κ°€μλ©΄, μ¤ν”„λ§ μ»¨ν…μ΄λ„μ—μ„ μ „μ²΄ λ“±λ΅λ μ¤ν”„λ§ λΉμ„ κ°€μ Έμ™€μ„ μ‚¬μ©μκ°€ μ§μ ‘ λ“±λ΅ν• κ°μ²΄ (ROLE_APPLICATION) λ“¤λ§ μ •λ¦¬ν•μ—¬ μ¶λ ¥ν•λ‹¤. `BeanDefinition`μ€ κ°μ²΄μ λ©”νƒ€λ°μ΄ν„°λ¥Ό ν¬ν•¨ν•κ³  μλ” κ°μ²΄μ΄λ‹¤.
![](__GHOST_URL__/content/images/2023/01/image-5.png)μ „μ²΄ ν…μ¤νΈ μ‹¤ν–‰ κ²°κ³Ό
μ‹¤ν–‰ κ²°κ³Όλ¥Ό λ³΄λ©΄ Config κ°μ²΄λ¥Ό ν¬ν•¨ν•μ—¬ BeanμΌλ΅ λ“±λ΅ν• κ°μ²΄λ“¤μ΄ μ μ¶λ ¥ λκ³ , μ§μ ‘ μ§€μ •ν• κ°μ²΄ λ°ν™ νƒ€μ…μ΄ μ¶λ ¥λκ³  μλ” κ²ƒμ„ ν™•μΈν•  μ μλ‹¤.

### 3.2 μλ™ λ“±λ΅

μ¤ν”„λ§ μ• ν”λ¦¬μΌ€μ΄μ…μ΄ μ‹μ‘ν•λ©΄μ„ μ»΄ν¬λ„νΈ μ¤μΊ”μ„ ν†µν•΄ κ°μ²΄λ“¤μ„ μμ§‘ν•κ³  μ¤ν”„λ§ λΉμΌλ΅μ¨ μλ™μΌλ΅ μ €μ¥ν•λ‹¤κ³  μ•μ„ μ„¤λ…ν• λ°” μλ‹¤.

κ·Έλ ‡λ‹¤λ©΄ μλ™μΌλ΅ λΉμΌλ΅ μμ§‘λλ” κ°μ²΄λ“¤μ€ μ–΄λ– ν• κ°μ²΄λ“¤μΌκΉ?

μ‚¬μ‹¤μ€ μ„μ—μ„ μλ™ λ“±λ΅μ„ ν…μ¤νΈν•λ©° ν• κ°€μ§€ μλ™ λ“±λ΅μ μλ¥Ό μ΄λ―Έ μ‚΄ν΄λ³΄μ•λ‹¤. λ°”λ΅ `@Configuration` μ• λ…Έν…μ΄μ…μ΄ λ¶™μ€ μ„¤μ • κ°μ²΄μ΄λ‹¤.

μ¤ν”„λ§μ—μ„λ” μμ£Ό μ“°λ” κ°μ²΄λ“¤ λ‡ κ°€μ§€λ¥Ό λ€μƒμΌλ΅ ν•λ” μ• λ…Έν…μ΄μ…μ΄ μ΅΄μ¬ν•λ”λ° μ΄ μ• λ…Έν…μ΄μ…λ“¤μ„ μ¤ν”„λ§μ΄ κΈ°λ™ν•λ©° μλ™μΌλ΅ μμ§‘ν•λ‹¤.

λ€ν‘μ μΈ μλ΅λ” `@Configuration` , `@Controller` , `@Service` , `@Repository` λ“±μ΄ μλ‹¤.

μ΄λ“¤μ€ λ¨λ‘ `@Component` μ• λ…Έν…μ΄μ…μ„ μƒμ†λ°›λ”λ°, κ²°κµ­ `@Component` μ• λ…Έν…μ΄μ…μ΄ λ¶™μ€ κ°μ²΄λ¥Ό λ¨λ‘ μμ§‘ν•λ‹¤κ³  μ •λ¦¬ν•  μ μλ‹¤.
![](__GHOST_URL__/content/images/2023/01/image-6.png)Configuration μ• λ…Έν…μ΄μ… λ‚΄λ¶€
> μ• λ…Έν…μ΄μ…μ μƒμ†μ€ κ³µμ‹μ μΈ μλ°” λ¬Έλ²•μ΄ μ•„λ‹κ³ , μ¤ν”„λ§μ΄ νΈμμƒ μ κ³µν•λ” κΈ°λ¥μ΄λ‹¤.

μ›λλΌλ©΄ μ¤ν”„λ§μ΄ κΈ°λ™λλ©΄μ„ μ»΄ν¬λ„νΈ μ¤μΊ”μ΄ ν•λ² μ΄λ£¨μ–΄μ§€μ§€λ§, μ°λ¦¬λ” ν…μ¤νΈ ν™κ²½μ—μ„ μ»΄ν¬λ„νΈ μ¤μΊ”μ„ μλ™μΌλ΅ μ‹¤ν–‰ν•΄ μ£Όμ–΄μ•Ό ν•κΈ° λ•λ¬Έμ— λ³„λ„μ μ„¤μ • ν™κ²½μ„ λ§λ“¤μ–΄ λ³΄μ.

    @Configuration
    @ComponentScan(
            basePackages = "jwjung.spring.remind",
            excludeFilters = @ComponentScan.Filter(
            	type = FilterType.ANNOTATION, classes = Configuration.class
            )
    )
    public class MemberAutoConfig {
    }

    @Repository
    public class MemoryMemberRepository implements MemberRepository {
    // μ΄ν• μƒλµ

    @Service
    public class MemberServiceImpl implements MemberService {
    // μ΄ν• μƒλµ

μ»΄ν¬λ„νΈ μ¤μΊ”λ§μ„ λ…μ‹ν•λ” Config κ°μ²΄λ¥Ό μƒμ„±ν•κ³  μ¤μΊ”μ λ€μƒμ΄ λ  κ°μ²΄λ“¤μ— λ‹¤μκ³Ό κ°™μ΄ `@Component`μ ν•μ„ μ• λ…Έν…μ΄μ…μ„ λ¶™μ—¬μ¤€λ‹¤.

κ·Έλ¦¬κ³  μ•„κΉ ν–λ ν…μ¤νΈμ™€ λΉ„μ·ν•κ² ν…μ¤νΈλ¥Ό μ‘μ„±ν•΄λ³΄μ.

    public class ComponentScanTest {
    
        AnnotationConfigApplicationContext ac = 
        	new AnnotationConfigApplicationContext(MemberAutoConfig.class);
    
        @Test
        @DisplayName("μ „μ²΄ μ• ν”λ¦¬μΌ€μ΄μ… λΉ μ΅°νν•κΈ°")
        void findAllBeans() {
            String[] beanDefinitionNames = ac.getBeanDefinitionNames();
            for (String beanName : beanDefinitionNames) {
    
                BeanDefinition beanDefinition = ac.getBeanDefinition(beanName);
    
                if (beanDefinition.getRole() == BeanDefinition.ROLE_APPLICATION) {
    
                    Object bean = ac.getBean(beanName);
                    System.out.println("beanName = " + beanName + " | bean = " + bean);
                }
            }
        }
    }

![](__GHOST_URL__/content/images/2023/01/image-7.png)ν…μ¤νΈ μ‹¤ν–‰ κ²°κ³Ό
λ¶„λ… `Config` κ°μ²΄ λ‚΄μ— λ…μ‹ν• μ¤ν”„λ§ λΉμ΄ μ—†μμ—λ„ λ¶κµ¬ν•κ³  Service κ°μ²΄μ™€ `Repository` κ°μ²΄κ°€ μ¤ν”„λ§ λΉμΌλ΅ μ»¨ν…μ΄λ„ μ•μ— μ €μ¥λμ–΄ μμμ„ ν™•μΈν•  μ μλ‹¤.

μ΄λ¥Ό ν†µν•΄ μ–΄λ–»κ² μ—¬νƒκΉμ§€ μΌμΌν λ…μ‹μ μΈ DIλ¥Ό μ§€μ •ν•μ§€ μ•μ•„λ„ μμ΅΄μ„±μ΄ μ£Όμ…λμ–΄ μ™”λ”μ§€λ¥Ό μ•μ•„λ³΄μ•λ‹¤.

κ·Έλ ‡λ‹¤λ©΄ νΉμ‹ κ°™μ€ λ¶€λ¨ μΈν„°νμ΄μ¤λ¥Ό μƒμ†λ°›λ” κµ¬ν„μ²΄ λ‘κ°κ°€ λ¨λ‘ μ»΄ν¬λ„νΈλ΅ λ“±λ΅λμ–΄ μλ‹¤λ©΄, μ¤ν”„λ§μ΄ `MemberServiceImpl` μ— μ£Όμ…ν•  κ°μ²΄λ¥Ό μ–΄λ–»κ² νλ‹¨ν•  μ μμ„κΉ?

`MemberRepository`λ¥Ό μƒμ†λ°›λ” `MemoryMemberRepository` μ™€ `JpaMemberRepository` μ–‘μ½μ— λ¨λ‘ `@Repository` μ• λ…Έν…μ΄μ…μ„ λ¶™μ΄κ³  κ°™μ€ ν…μ¤νΈ λ©”μ„λ“λ¥Ό μ‹¤ν–‰ν•΄λ³΄μ.
![](__GHOST_URL__/content/images/2023/01/image-8.png)
λ‹¤μκ³Ό κ°™μ€ μΉμ ν• μ—λ¬ λ¬Έκµ¬λ¥Ό ν™•μΈν•  μ μλ‹¤.

No qualifying bean of type 'jwjung.spring.remind.repository.MemberRepository' available: expected single matching bean but found 2: jpaMemberRepository,memoryMemberRepository

`MemberServiceImpl` κ°μ²΄μ— μ£Όμ…ν•΄μ•Ό ν•  μμ΅΄μ„±μ„ μ¤ν”„λ§μ΄ νλ‹¨ ν•  μκ°€ μ—†μΌλ―€λ΅ `NoUniqueBeanDefinitionException` λ°νƒ€μ„ μμ™Έκ°€ λ°μƒν•λ‹¤.

μ΄λ΄λ• λ‘κ°€μ§€ λ°©λ²•μ„ ν†µν•΄ κ°μ²΄ μ£Όμ… μ„ νƒκ¶μ„ κ²°μ •ν•  μ μλ”λ°, μ²«λ²μ§Έλ” `@Primary` μ• λ…Έν…μ΄μ…μ„ μ‚¬μ©ν•λ” λ°©λ²•κ³Ό, `@Qualifer` μ• λ…Έν…μ΄μ…μ„ μ‚¬μ©ν•λ” λ°©λ²•μ΄λ‹¤.

`@Primary` μ• λ…Έν…μ΄μ…μ„ μ‚¬μ©ν•λ” λ°©λ²•μ€ μ• λ§¤ν• μƒν™©μ μ—¬λ¬ κ°€μ§€ κµ¬ν„μ²΄μ¤‘, μ‹¤μ λ΅ μ£Όμ…λ°›μ„ κ°μ²΄ μ„μ— `@Primary` μ• λ…Έν…μ΄μ…μ„ λ¶™μ—¬μ£Όλ” κ²ƒμ΄λ‹¤.

    @Repository
    @Primary
    public class MemoryMemberRepository implements MemberRepository {
    // μ΄ν• μƒλµ

λ ν•κ°€μ§€ `@Qualifer` μ• λ…Έν…μ΄μ…μ„ μ‚¬μ©ν•λ” λ°©λ²•μ€, κ° κµ¬ν„μ²΄μ— `@Qualifer` μ• λ…Έν…μ΄μ…μΌλ΅ λ…μΉ­μ„ λ…μ‹ν•κ³ , μ‹¤μ λ΅ μ£Όμ…λ°›λ” κ°μ²΄μ—λ„ μ£Όμ…λ°›λ” λ€μƒμ `@Qualifer` μ• λ…Έν…μ΄μ…μ„ μΌμΉμ‹μΌμ£Όλ©΄ λλ‹¤.

    @Repository
    @Qualifier("memoryMemberRepository")
    public class MemoryMemberRepository implements MemberRepository {
    // μ΄ν• μƒλµ

    @Repository
    @Qualifier("jpaMemberRepository")
    public class JpaMemberRepository implements MemberRepository {
    // μ΄ν• μƒλµ

    @Service
    public class MemberServiceImpl implements MemberService {
    
        private MemberRepository memberRepository;
    
        public MemberServiceImpl(@Qualifier("memoryMemberRepository") 
        	MemberRepository memberRepository) {
            this.memberRepository = memberRepository;
        }
        
        // μ΄ν• μƒλµ

## 4. λ§λ¬΄λ¦¬

μ§€κΈκΉμ§€ κ°μ²΄μ§€ν–¥μ μΈ μ„¤κ³„λ¥Ό λ„μ™€μ£Όλ” μ¤ν”„λ§μ λΉ κ΄€λ ¨ κΈ°λ¥μ„ μμ°¨μ μΌλ΅ μ•μ•„λ³΄μ•λ‹¤.

λ‹¨μν μ¤ν”„λ§μ΄ μ κ³µν•λ” κΈ°λ¥μ„ μ‚¬μ©ν•κΈ°λ§ ν•λ‹¤κ°€ λ¬΄μ¨ μ΄μ λ΅ μ΄λ¬ν• κΈ°λ¥λ“¤μ„ μ κ³µν•κΈ°μ— μ΄λ¥΄λ €λ”μ§€ ν•λ² κ³µλ¶€ν•΄λ³΄λ” μ μµν• μ‹κ°„μ΄μ—λ‹¤.
