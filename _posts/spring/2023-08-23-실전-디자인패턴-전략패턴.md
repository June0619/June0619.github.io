---
title: "[Spring] ë””ìì¸íŒ¨í„´ ì ìš© - ì „ëµ íŒ¨í„´"
tags: 
    - Spring
    - Design Pattern
categories:
    - Spring
---

## 1. ì „ëµ íŒ¨í„´ì´ë€
ì „ëµ íŒ¨í„´ì€ ì•Œê³ ë¦¬ì¦˜ì„ ê·¸ë£¹ìœ¼ë¡œ ì •ì˜í•˜ê³ , ê° ê·¸ë£¹ì„ ë³„ë„ì˜ í´ë˜ìŠ¤ì—ì„œ ê´€ë¦¬í•˜ë©° ê·¸ë£¹ì˜ ì•Œê³ ë¦¬ì¦˜ì„ ì„ íƒì ìœ¼ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ í•˜ëŠ” í–‰ë™ ë””ìì¸íŒ¨í„´ì´ë‹¤.

ì›Œë‚™ ìœ ëª…í•˜ë©° ìŠ¤í”„ë§ í”„ë ˆì„ì›Œí¬ ë° JAVA API ë‚´ì—ì„œë„ ì•„ì£¼ ë§ì´ ì°¾ì•„ë³¼ ìˆ˜ ìˆëŠ” ë””ìì¸ íŒ¨í„´ì´ë‹¤.

## 2. ì ìš© ê³„ê¸°
ê¸°ì¡´ì— íšŒì‚¬ì—ì„œ ì§€ì›í•˜ëŠ” ê²°ì œ ìˆ˜ë‹¨ì´ ë§ì§€ ì•Šì•˜ëŠ”ë°, ì´ë²ˆì— ì‹ ê·œ ì•± ëŸ°ì¹­ê³¼ ë”ë¶ˆì–´ ë‹¤ì–‘í•œ ê²°ì œ ìˆ˜ë‹¨ì„ ì§€ì›í•˜ê²Œ ë˜ì—ˆë‹¤.

ì •ì‚° ëª¨ë“ˆë„ ê·¸ì— ë§ì¶”ì–´ ì—¬ëŸ¬ ê²°ì œìˆ˜ë‹¨ì— ë”°ë¥¸ ë¹„ì§€ë‹ˆìŠ¤ ë¡œì§ì„ ì†Œí™”í•˜ë„ë¡ ë³€ê²½í•´ì•¼ í•˜ëŠ” ìƒí™©ì´ì—ˆë‹¤.

ê¸°ì¡´ì— ì§€ì›í•˜ë˜ ê²°ì œ ìˆ˜ë‹¨ì„ í¸ì˜ìƒ A, B, C ë¼ê³  ì¹­í•˜ê² ë‹¤.

ìµœì´ˆ ê²°ì œ ìˆ˜ë‹¨ì„ ëŠ˜ë¦¬ë ¤ë˜ ì‹œì ì—ì„œëŠ” ë‹¨ìˆœí•˜ê²Œ ë¶„ê¸°ë¬¸ì„ í†µí•´ A,B,C ê²°ì œìˆ˜ë‹¨ì„ ë¶„ê¸°í•˜ë„ë¡ ì‘ì„±ë˜ì–´ ìˆì—ˆë‹¤.

```java

@Service
@RequiredArgsConstructor
public class purchaseService {

    private final PaymentMethodAService aService;
    private final PaymentMethodBService bService;
    private final PaymentMethodCService cService;

    public Result purchase(PurchaseInfo purchaseInfo) {

        PaymentMethod paymentMethod = purchaseInfo.getPaymentMethod();

        if (paymentMethod == PaymentMethod.A) {
            return aService.pay(purchaseInfo);
        } else if (paymentMethod == PaymentMethod.B) {
            return bService.pay(purchaseInfo);
        } else if (paymentMethod == PaymentMethod.C) {
            return cService.pay(purchaseInfo);
        } else {
            throw new IllegalArgumentException("payment method not found");
        }
    }

    public Result refund(RefundInfo refundInfo) {

        PaymentMethod paymentMethod = refundInfo.getPaymentMethod();

        if (paymentMethod == PaymentMethod.A) {
            return aService.refund(refundInfo);
        } else if (paymentMethod == PaymentMethod.B) {
            return bService.refund(refundInfo);
        } else if (paymentMethod == PaymentMethod.C) {
            return cService.refund(refundInfo);
        } else {
            throw new IllegalArgumentException("payment method not found");
        }
    }
}

```

ìœ„ ì½”ë“œë¥¼ ë³´ë©´ ìš°ì„  ì–¼í• ë´ë„ ì„¸ ê°€ì§€ ì •ë„ì˜ ë¬¸ì œì ì´ ë³´ì¸ë‹¤.

1. ê²°ì œ ìˆ˜ë‹¨ì´ ì¶”ê°€ ë˜ëŠ” ê²½ìš° ê³ ì¹  ì½”ë“œê°€ ë„ˆë¬´ ë§ë‹¤.
2. ê²°ì œ ê´€ë ¨ ê¸°ëŠ¥ì´ ì¶”ê°€ë˜ëŠ” ê²½ìš° ê³ ì¹  ì½”ë“œê°€ ë„ˆë¬´ ë§ë‹¤.
3. ê²°ì œ ìˆ˜ë‹¨ì´ ëŠ˜ì–´ë‚  ë•Œ ë§ˆë‹¤ ì˜ì¡´ì„± ë˜í•œ ëŠ˜ì–´ë‚œë‹¤. (ë‹¨ìœ„í…ŒìŠ¤íŠ¸ ì‹œ ë¶ˆí•„ìš”í•œ ì½”ë“œì‘ì„± ì‹œê°„ ì¦ê°€)

ì´ì œ ë‹¤ìŒ ì½”ë“œë¥¼ ì „ëµ íŒ¨í„´ì„ ì ìš©í•¨ìœ¼ë¡œì¨ ë¬¸ì œì ì„ í•´ê²°í•´ë³´ì.

## 3. ì ìš©

ìš°ì„  ê³µí†µì ìœ¼ë¡œ `ê²°ì œ`, `í™˜ë¶ˆ` ë“± í•µì‹¬ì ì¸ ë‚´ìš©ì„ ì¶”ìƒí™” í•˜ì—¬ ì¸í„°í˜ì´ìŠ¤ë¡œ ë§Œë“ ë‹¤.

```java
public interface PaymentMethodService

Result purchase(PurchaseInfo purchaseInfo);
Result refund(RefundInfo refundInfo);
```

ê·¸ë¦¬ê³  ê²°ì œ ìˆ˜ë‹¨ë“¤ì´ í•´ë‹¹ ì¸í„°í˜ì´ìŠ¤ë¥¼ ìƒì†ë°›ë„ë¡ ë³€ê²½í•œë‹¤.

```java
@Service("AMethod")
public class PaymentMethodAService implements PaymentMethodService {
    //...
}
```

```java
@Service("BMethod")
public class PaymentMethodBService implements PaymentMethodService {
    //...
}
```

ë‹¤ìŒê³¼ ê°™ì´ ì—¬ëŸ¬ í´ë˜ìŠ¤ê°€ ì¸í„°í˜ì´ìŠ¤ë¥¼ ìƒì† ë°›ìœ¼ë©´ Bean ì£¼ì… ì‹œ `Map` ì´ë‚˜ `List` ì™€ ê°™ì€ ì»¬ë ‰ì…˜ í˜•íƒœë¡œ ê°ì²´ë“¤ì„ ê°€ì ¸ì˜¬ ìˆ˜ ìˆë‹¤.

ë”°ë¼ì„œ ì²˜ìŒ ì½”ë“œë¥¼ ë‹¤ìŒê³¼ ê°™ì´ ìˆ˜ì • ê°€ëŠ¥í•˜ë‹¤.

```java
@Service
@RequiredArgsConstructor
public class purchaseService {

    private final Map<String, PaymentMethodService> paymentMethodServiceMap;

    public Result purchase(PurchaseInfo purchaseInfo) {

        String paymentMethod = purchaseInfo.getPaymentMethod().getName();

        return paymentMethodServiceMap.computeIfAbsent(paymentMethod, key -> {
            throw new IllegalArgumentException("payment method not found");
        }).pay(purchaseInfo);
    }

    public Result refund(RefundInfo refundInfo) {

        String paymentMethod = refundInfo.getPaymentMethod().getName();

        return paymentMethodServiceMap.computeIfAbsent(paymentMethod, key -> {
            throw new IllegalArgumentException("payment method not found");
        }).refund(refundInfo);
    }
}
```

ë‹¤ìŒê³¼ ê°™ì´ ì „ëµ íŒ¨í„´ì„ ì ìš© í•¨ìœ¼ë¡œì¨ ì•ì„œ ë‹¤ë£¬ 3ê°€ì§€ ë¬¸ì œì ì´ ê¹”ë”í•˜ê²Œ í•´ê²°ë˜ì—ˆë‹¤.

ì‹¤ì œë¡œ ì´ ì´í›„ ê²°ì œ ìˆ˜ë‹¨ì´ ëª‡ ê°€ì§€ ì¶”ê°€ë˜ì—ˆìœ¼ë‚˜, ê¸°ì¡´ ì½”ë“œì˜ ìˆ˜ì • ì—†ì´ `PaymentMethodService` ë¥¼ ìƒì†ë°›ëŠ” í´ë˜ìŠ¤ë§Œ ì¶”ê°€í•¨ìœ¼ë¡œì¨ ì•ˆì „í•˜ê³  í¸ë¦¬í•œ í™•ì¥ì´ ê°€ëŠ¥ í–ˆì—ˆë‹¤. ğŸ‘